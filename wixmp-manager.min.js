/*!
 * wixmp-manager-sdk - v1.0.5 - 2015-02-16
 *
 * Copyright (c) 2015 Wix.com
 * Licensed MIT
 */

!function(){var a=window.Promise;a!==window.P&&console.warn("Bluebird is not available, cancel and progress will not work");var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb;b=function(a){if("string"!=typeof a)throw new Error("URI is not a string");return a.replace(/([a-z\-_0-9]+)\/\//gi,"$1/")},c=function(){function a(a,b,c){var d;return c?(d=b.map(c),b[d.indexOf(Math[a].apply(null,d))]):Math[a].apply(this,b)}var b={extend:function(a){var b=Array.prototype.slice.call(arguments,1);return b.forEach(function(b){"object"==typeof b&&null!=b&&Object.keys(b).forEach(function(c){a[c]=b[c]})}),a},merge:function(){var a=Object.prototype.hasOwnProperty;return Array.prototype.reduce.call(arguments,function(b,c){return Object.keys(b).forEach(function(d){a.call(c,d)&&(b[d]=c[d])}),Object.keys(c).forEach(function(a){b[a]=c[a]}),b},{})},partial:function(a){var b=Array.prototype.slice.call(arguments,1);return function(){var c=Array.prototype.slice.call(arguments);return a.apply(this,b.concat(c))}},getParameterByName:function(a,b){var c,d;return b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),c=new RegExp("[\\?&]"+b+"=([^&#]*)"),d=c.exec(a),d?decodeURIComponent(d[1].replace(/\+/g," ")):""},snakeToCamel:function(a){return a.replace(/(\_[a-z])/g,function(a){return a.toUpperCase().replace("_","")})},find:function(a,b){var c;return a.some(function(a){return b(a)===!0?(c=a,!0):void 0}),c},encodeParams:function(a){var b=[],c=function(a,c){b[b.length]=encodeURIComponent(a)+"="+encodeURIComponent(c)};return Object.keys(a).forEach(function(b){c(b,a[b])}),b.join("&").replace(/%20/g,"+")}};return b.min=b.partial(a,"min"),b.max=b.partial(a,"max"),b}(),d=function(a,b,c){var d,e,f,g,h,i,j,k,l,m;return m={withCredentials:!1,cache:!0,headers:{Accept:"application/json, text/plain, */*"}},a.prototype.progress=function(a){return this._progressCallback=a,this},a.prototype.notify=function(a){return"function"==typeof this._progressCallback&&this._progressCallback(a),this},l=function(b,d,e){var f=new a(function(a,d){b.addEventListener("error",function(){d(j(c.extend({},b,{statusText:"error"})))},!1),b.addEventListener("timeout",function(){d(j(c.extend({},b,{statusText:"timeout_has_exceeded"})))},!1),b.addEventListener("load",function(){/^2\d+/.test(b.status.toString())?a(j(b)):d(j(b))},!1)});return e&&(b.upload.onprogress=function(a){var b=Math.round(a.lengthComputable?100*a.loaded/a.total:0);f.notify(b)}),f.cancellable()["catch"](function(){b.abort()}),d(),f},j=function(a){return{status:a.status,statusText:a.statusText,data:k(a.responseText)}},k=function(a){return"string"==typeof a&&(a=["{","["].indexOf(a[0])>=0?JSON.parse(a):{message:a}),a},i=function(a,b){if(!b)return a;var c=[];return Object.keys(b).forEach(function(a){var d=b[a];null!==d&&"undefined"!=typeof d&&(d instanceof Array||(d=[d]),d.forEach(function(b){b instanceof Date&&!isNaN(b.valueOf())?b=b.toISOString():"object"==typeof b&&(b=JSON.stringify(b)),c.push(h(a)+"="+h(b))}))}),c.length>0&&(a+=(-1===a.indexOf("?")?"?":"&")+c.join("&")),a},h=function(a){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")},g=function(a,c,d){var e=new XMLHttpRequest;return d.cache===!1&&(c+=(-1===c.indexOf("?")?"?":"&")+"_="+Date.now()),e.open(a.toUpperCase(),b(c)),e.responseType=d.responseType,e.withCredentials=d.withCredentials,Object.keys(d.headers).forEach(function(a){e.setRequestHeader(a,d.headers[a])}),e},e=function(a,b,d){var e=g("get",i(a,b),c.extend({},m,d));return l(e,function(){e.send(null)})},d=function(a,b,d){var e=g("post",a,c.extend({},m,{headers:{"Content-Type":"application/json;charset=UTF-8"}},d));return l(e,function(){b&&"object"==typeof b&&b instanceof FormData==!1&&(b=JSON.stringify(b)),e.send(b)})},f=function(a,b,d){var e,f=g("post",a,c.extend({},m,d));return e=new FormData,Object.keys(b).forEach(function(a){var c=b[a],d="file"===a?[a,c,c.name]:[a,c];return e.append.apply(e,d)}),l(f,function(){f.send(e)},!0)},{get:e,post:d,upload:f}}(a,b,c),e=function(a){function b(){}function c(a,b){a.forEach(function(a){a(b)})}function d(a,b,c){a.forEach(function(a){a[b](c)})}function e(c,e,f){if("undefined"==typeof i[e])return{resolveAt:b,rejectAt:b};var g=[],h=[];return i[e].forEach(function(b){var c=[],d=[],e=f.promises.map(function(){return new a(function(a,b){c.push(a),d.push(b)})});g.push(c),h.push(d),b(e,f)}),{resolveAt:function(a,b){d(g,a,b)},rejectAt:function(a,b){d(h,a,b)}}}function f(d,f,g){if("object"!=typeof d||null===d)throw new Error("target should be a function");if("string"!=typeof f)throw new Error("eventName should be a string");if(g=g||{},g.eventTarget=d,g.eventName=f,g.promises&&g.promises.length)return e(d,f,g);if("undefined"==typeof i[f])return{resolve:b,reject:b};var h=[],j=[];return i[f].forEach(function(b){var c=new a(function(a,b){h.push(a),j.push(b)});b(c,g)}),{resolve:function(a){c(h,a)},reject:function(a){c(j,a)}}}function g(a,b){"undefined"==typeof i[a]&&(i[a]=[]),i[a].push(b)}function h(a,b){if(i[a]){var c=i[a].indexOf(b);i[a].splice(c,1)}}var i={};return{emit:f,addListener:g,removeListener:h}}(a),f=function(a,b){return function(c,d){if("function"!=typeof c)throw new Error("Source constructor should be a function");if("undefined"!=typeof d&&("object"!=typeof d||null===d))throw new Error("Source settings should be an object");return new c(d,b.emit,a)}}(d,e),g=function(a){return{id:a.folder_id,name:a.folder_name,mediaType:a.media_type,filesCount:a.files_count,createdAt:a.created_ts}},h={toObject:function(a){return a?"string"==typeof a?JSON.parse(a):a:null},toError:function(a){return{code:a.status,message:a.statusText||a.data.message||a.data.error&&a.data.error.message||"",data:a.data.errors||a.data.error||a.data}}},i=function(a,b){return function(c){return 403===c.status&&"Missing Wix session"===c.data.error_description&&(c.status=401,c.data.message="Wix Session required"),a.reject(b.toError(c))}}(a,h),j=function(a,b,c){return function(d){function e(a){return c(a)}function f(c,f){return f=f||{},a.get(d.apiUrl+"/folders",{media_type:f.mediaType||"picture",folder_id:c||null},{withCredentials:!0}).then(function(a){return{data:a.data.folders.map(b)}},e)}function g(b){return a.post(d.apiUrl+"/folders/"+b+"/delete",null,{withCredentials:!0}).then(function(){return b},e)}function h(a){return a.map(g)}return{list:f,remove:h}}}(d,g,i),k=function(a){return"object"!=typeof a||null===a?{valid:!1,message:"Please specify new props"}:"undefined"==typeof a.name||a.name?"undefined"==typeof a.folderId||a.folderId?{valid:!0}:{valid:!1,message:"Please specify folder id"}:{valid:!1,message:"Please specify name"}},l=function(a,b,c,d,e){return function(f){function g(a){return d(a)}function h(b,d){return b?(d=d||{},a.post(f.apiUrl+"/folders",{folder_name:b,media_type:d.mediaType||"picture"},{withCredentials:!0}).then(function(a){return a.data=c(a.data),a},g)):g({status:-200,statusText:"Internal JS Error",data:{message:"Please specify name"}})}function i(c,d){var h=e(d);return h.valid===!1?g({status:-200,statusText:"Internal JS Error",data:{message:h.message}}):a.post(f.apiUrl+"/folders/"+c.id+"/put",{folder_name:d.name},{withCredentials:!0}).then(function(a){return a.data=b.merge(c,d),a},g)}return{create:h,update:i}}}(d,c,g,i,k),m=function(a,b){var c,d,e;return c=function(a,b){return"rembrandt"===b.imageOperationsApi?d(a,b):e(a,b)},d=function(b,c){function d(a){return a.replace(h,"")}function e(a){return h.exec(a)[1]}var f,g,h=/([^\/]+)$/;switch(b.media_type){case"picture":case"site_icon":return{thumbnailUrl:a(c.filesUrl+"/"+d(b.file_url)+"/v1/fill/w_195,h_195/"+e(b.file_url)),previewUrl:a(c.filesUrl+"/"+d(b.file_url)+"/v1/fit/w_375,h_375/"+e(b.file_url)),originalUrl:a(c.filesUrl+"/"+d(b.file_url)+"/"+e(b.file_url))};case"document":return{thumbnailUrl:a(c.filesUrl+"/"+b.icon_url),previewUrl:a(c.filesUrl+"/"+b.icon_url),originalUrl:a(c.filesUrl+"/"+b.file_url)};case"music":case"secure_music":return{thumbnailUrl:"./images/music-preview.png",previewUrl:"./images/music-preview.png",originalUrl:a(c.filesUrl+"/"+b.file_url)};case"video":return g=b.icon_url?a(c.filesUrl+"/"+b.icon_url):"./images/video-preview.png",{thumbnailUrl:g,previewUrl:g,originalUrl:a(c.filesUrl+"/"+b.file_url)};case"ufonts":return f=b.file_name.replace(/\..*/,""),{thumbnailUrl:a(c.filesUrl+"/"+b.icon_url),previewUrl:a(c.filesUrl+"/media"+f+"_prvw.jpg"),originalUrl:a(c.filesUrl+"/"+b.file_url)};case"swf":return{thumbnailUrl:a((c.staticFiles||"http://static.wix.com")+"/services/web/2.690.2/images/web/flash_swf_icon.png"),previewUrl:a((c.staticFiles||"http://static.wix.com")+"/services/web/2.690.2/images/web/flash_swf_icon.png"),originalUrl:a(c.filesUrl+"/"+b.file_url)};case"watermark":return{thumbnailUrl:a(c.filesUrl+"/"+b.icon_url),previewUrl:a(c.filesUrl+"/"+b.icon_url),originalUrl:a(c.filesUrl+"/"+b.file_url)};default:return{thumbnailUrl:a(c.filesUrl+"/"+b.icon_url),previewUrl:a(c.filesUrl+"/"+b.icon_url),originalUrl:a(c.filesUrl+"/"+b.file_url)}}},e=function(b,c){var d;switch(b.media_type){case"picture":case"site_icon":return{thumbnailUrl:a(c.filesUrl+"/"+b.file_url+"_srz_210_210_75_22_0.5_1.20_0.00_jpg_srz"),previewUrl:a(c.filesUrl+"/"+b.file_url+"_srb_375_375_75_22_0.5_1.20_0.00_jpg_srb"),originalUrl:a(c.filesUrl+"/"+b.file_url)};case"document":case"music":case"secure_music":return{thumbnailUrl:a(c.filesUrl+"/"+b.icon_url),previewUrl:a(c.filesUrl+"/"+b.icon_url),originalUrl:a(c.filesUrl+"/"+b.file_url)};case"ufonts":return d=b.file_name.replace(/\..*/,""),{thumbnailUrl:a(c.filesUrl+"/"+b.icon_url),previewUrl:a(c.filesUrl+"/media"+d+"_prvw.jpg"),originalUrl:a(c.filesUrl+"/"+b.file_url)};case"swf":return{thumbnailUrl:a((c.staticFiles||"http://static.wix.com")+"/services/web/2.690.2/images/web/flash_swf_icon.png"),previewUrl:a((c.staticFiles||"http://static.wix.com")+"/services/web/2.690.2/images/web/flash_swf_icon.png"),originalUrl:a(c.filesUrl+"/"+b.file_url)};case"watermark":return{thumbnailUrl:a(c.filesUrl+"/"+b.icon_url),previewUrl:a(c.filesUrl+"/"+b.icon_url),originalUrl:a(c.filesUrl+"/"+b.file_url)};default:return{thumbnailUrl:a(c.filesUrl+"/"+b.icon_url),previewUrl:a(c.filesUrl+"/"+b.icon_url),originalUrl:a(c.filesUrl+"/"+b.file_url)}}},function(d,e){var f={id:d.file_name,folderId:d.parent_folder_id||null,name:d.original_file_name,mediaType:d.media_type,fileUrl:a(d.file_url),createdAt:d.created_ts,tags:d.tags,width:d.width||null,height:d.height||null,fileInfo:b.toObject(d.file_info),fileInput:b.toObject(d.file_input),fileOutput:b.toObject(d.file_output)};return f.thumbnailUrl=c(d,e).thumbnailUrl,f.originalUrl=c(d,e).originalUrl,f.previewUrl=c(d,e).previewUrl,f}}(b,h),n=function(a,b,c,d,e,f){return function(a){function c(a){return f(a)}function g(b){return b.data.files&&b.data.files.length?b.data.files.map(function(b){return e(b,a)}):[]}function h(e,f){f=f||{};var h=d.extend(l,f.sort),i=d.extend(k,f.paging),j={page_size:i.size,cursor:f.cursor,parent_folder_id:e,media_type:f.mediaType};return j.order="desc"===h.direction?"-"+h.order:h.order,b.get(a.apiUrl+"/files/getpage",j,{withCredentials:!0}).then(function(a){return{data:g(a),paging:{size:i.size,cursor:a.data.cursor}}},c)}function i(d){return b.post(a.apiUrl+"/files/"+d+"/delete",null,{withCredentials:!0}).then(function(){return d},c)}function j(a){return a.map(i)}var k={size:50,cursor:null},l={order:"date",direction:"desc"};return{list:h,remove:j}}}(a,d,b,c,m,i),o=function(a,b,c,d,e,f,g){return function(h){function i(a){return f(a)}function j(a){function c(a){return"secure_music"===a?"music-goods/upload":"video"===a?"video/upload":"upload"}return b.get(h.apiUrl+"/files/"+c(a.mediaType)+"/url",{media_type:a.mediaType,file_name:a.name,file_size:a.size,content_type:a.file.type},{withCredentials:!0})}function k(c,f){f=f||{};var g={url:d(c.url),media_type:c.mediaType,name:c.name||"Untitled",tags:c.tags||null,parent_folder_id:f.folderId||null};return new a(function(a,c){b.post(h.apiUrl+"/files/upload/external?url="+g.url+"&media_type="+g.media_type,g,{withCredentials:!0}).then(function(b){a(e(b.data,h))},c)})}function l(c,d){d=d||{};var f={parent_folder_id:d.folderId||null,file:c.file,media_type:c.mediaType},g=new a(function(a,d){j(c).then(function(c){var i=b.upload(c.data.upload_url,f,{withCredentials:!0});i.progress(function(a){g.notify(a)}),i.then(function(b){a(e(b.data[0],h))},d)},d)});return g}function m(a){return b.get(h.apiUrl+"/files/"+a,null,{withCredentials:!0,cache:!1}).then(function(a){return e(a.data,h)},i)}function n(a,d){var e=g(d);return e.valid===!1?i({status:-200,statusText:"Internal JS Error",data:{message:e.message}}):b.post(h.apiUrl+"/files/"+a.id+"/put",{original_file_name:d.name,parent_folder_id:d.folderId},{withCredentials:!0}).then(function(b){return b.data=c.merge(a,d),b},i)}return{upload:l,uploadByUrl:k,get:m,update:n}}}(a,d,c,b,m,i,k),p={apiUrl:"http://files.wix.com",imageOperationsApi:"vangogh",filesUrl:"http://static.wixstatic.com"},q=function(a,b,c){return{addEvents:function(d,e,f){var g={};return Object.keys(e).forEach(function(h){var i=c.snakeToCamel(h.toLowerCase());"function"==typeof f[i]&&(g[i]=function(){var c,g,j=arguments,k=f[i].apply(f,j),l={arguments:j};return Array.isArray(k)?(l.promises=k,c=b.emit(d,e[h],l),k.forEach(function(a,b){var d=a.then(function(a){c.resolveAt(b,a)},function(a){c.rejectAt(b,a)});a.progress(function(a){d.notify(a)})}),k):(c=b.emit(d,e[h],l),g=k.then(function(a){return c.resolve(a),a},function(b){return c.reject(b),a.reject(b)}),k.progress(function(a){g.notify(a)}),g)})}),g}}}(a,e,c),r={FOLDERS:{LIST:"folders.list",REMOVE:"folders.remove"},FOLDER:{CREATE:"folder.create",UPDATE:"folder.update",REMOVE:"folder.remove"},ITEMS:{LIST:"items.list",SEARCH:"items.search",REMOVE:"items.remove",UPLOAD:"items.upload",UPLOAD_BY_URL:"items.uploadByUrl"},ITEM:{GET:"item.get",UPDATE:"item.update",REMOVE:"item.remove",UPLOAD:"item.upload",UPLOAD_BY_URL:"item.uploadByUrl"}},s=function(a){return function(b){function c(){var b,c,d=new a(function(){b=arguments[0],c=arguments[1]});return{resolve:b,reject:c,promise:d}}function d(a,b,d){var e=a.map(function(a){var b=c();return g.push({item:a,deferred:b}),b});return h||(h=!0,i(g,function(a){return d(a.item,b).progress(function(b){a.deferred.promise.notify(b)}).then(a.deferred.resolve,a.deferred.reject)})),e.map(function(a){return a.promise})}function e(a,c){return d(a,c,b.item.upload)}function f(a,c){return d(a,c,b.item.uploadByUrl)}var g=[],h=!1,i=function(a,b){var c=a.shift();return console.log(c),c?void b(c)["finally"](function(){i(a,b)}):void(h=!1)};this.upload=e,this.uploadByUrl=f}}(a),t=function(a,b,c,d,e,f,g,h,i){return function(j){var k=f.extend({},e,j),l=a(k),m=b(k),n=c(k),o=d(k),p=new i(this);f.extend(n,{upload:p.upload,uploadByUrl:p.uploadByUrl}),this.name="private",this.folders=g.addEvents(this,h.FOLDERS,l),this.folder=g.addEvents(this,h.FOLDER,m),this.items=g.addEvents(this,h.ITEMS,n),this.item=g.addEvents(this,h.ITEM,o),this.items=g.addEvents(this,h.ITEMS,n),this.item=g.addEvents(this,h.ITEM,o)}}(j,l,n,o,p,c,q,r,s),u={apiUrl:"http://pix-test.wix.com/services/google"},v=function(a){return{id:a.gphoto$id.$t,name:a.title.$t,mediaType:"picture",parentId:null,filesCount:a.gphoto$numphotos.$t,createdAt:a.published.$t}},w=function(a){return function(b){return{data:b.feed.entry.map(a)}}}(v),x=function(a,b){return function(c){return a.reject(b.toError(c))}}(a,h),y=function(a,b,c){return function(d){function e(a){return b(a.data)}function f(a){return c(a)}function g(){return a.get(d.apiUrl+"/albums",{thumbsize:"150c","max-results":500},{withCredentials:!0}).then(e,f)}return{list:g}}}(d,w,x),z=function(a){function b(a){var b=a.media$thumbnail.filter(function(a){return!a.medium||"video"!==a.medium});return b[b.length-1].url||""}return function(c){var d,e,f,g,h;return d=b(c.media$group),e=+c.gphoto$width.$t||1024,f=+c.gphoto$height.$t||768,g=d.replace(/\/s[0-9]+/,"/w"+e+"-h"+f+"-no"),h=e>400?d.replace(/\/s[0-9]+(-c)?/,"/s400"):g,{id:c.id.$t,name:c.summary.$t||c.title.$t,mediaType:"picture",fileUrl:a(g),thumbnailUrl:a(d),previewUrl:a(h),createdAt:c.published.$t,tags:[],width:e,height:f}}}(b),A=function(a){return function(b){return{data:b.feed.entry.map(a),paging:{cursor:b.feed.openSearch$startIndex.$t+b.feed.openSearch$itemsPerPage.$t,pageSize:b.feed.openSearch$itemsPerPage.$t}}}}(z),B=function(a,b,c){return function(d){function e(a){return b(a.data)}function f(a){return c(a)}function g(b,c){c=c||{},c.paging=c.paging||{};var g={album_id:b||null,kind:"photo",thumbsize:"150c","max-results":c.paging.pageSize||50,"start-index":c.paging.cursor||1};return a.get(d.apiUrl+"/photos",g,{withCredentials:!0}).then(e,f)}return{list:g}}}(d,A,x),C=function(a,b,c,d,e){return function(){var f=b(a),g=c(a);this.folders=d.addEvents(this,e.FOLDERS,f),this.items=d.addEvents(this,e.ITEMS,g),this.name="picasa"}}(u,y,B,q,r),D={apiUrl:"http://pix-test.wix.com/services/instagram",api2Url:"http://pix-test.wix.com/services/instagram2"},E=function(a){return{id:"Instagram",name:"Instagram",mediaType:"picture",parentId:null,filesCount:a.counts.media,createdAt:null}},F=function(a){return function(b){return{data:[a(b)]}}}(E),G=function(a,b){return function(c){return 500===c.status&&(c.status=403,c.data={message:"Unauthorized",result:"error"}),a.reject(b.toError(c))}}(a,h),H=function(a,b,c){return function(d){function e(a){return b(a.data)}function f(a){return c(a)}function g(){return a.get(d.apiUrl+"/user",null,{withCredentials:!0}).then(e,f)}return{list:g}}}(d,F,G),I=function(a){return function(b){return b.caption||(b.caption={text:""}),{id:b.id,name:b.caption.text,mediaType:"picture",fileUrl:a(b.images.standard_resolution.url),thumbnailUrl:a(b.images.low_resolution.url),previewUrl:a(b.images.standard_resolution.url),createdAt:1e3*+b.created_time,tags:b.tags,width:b.images.standard_resolution.width,height:b.images.standard_resolution.height}}}(b),J=function(a){return function(b){b.next=b.next||{};var c=b.next.max_id||null,d=b.next.count||null;return{data:b.photos.map(a),paging:{cursor:c,pageSize:d}}}}(I),K=function(a,b,c){return function(d){function e(a){return b(a.data)}function f(a){return c(a)}function g(b,c){c=c||{},c.paging=c.paging||{};var g={count:c.paging.pageSize||50,max_id:c.paging.cursor||null};return a.get(d.api2Url+"/photos",g,{withCredentials:!0}).then(e,f)}return{list:g}}}(d,J,G),L=function(a,b,c,d,e){return function(){var f=b(a),g=c(a);this.name="instagram",this.folders=d.addEvents(this,e.FOLDERS,f),this.items=d.addEvents(this,e.ITEMS,g)}}(D,H,K,q,r),M={apiUrl:"http://pix-test.wix.com/services/facebook2"},N=function(a){return{id:a.id,name:a.name,mediaType:"picture",parentId:null,filesCount:a.count,createdAt:a.created_time}},O=function(a){return function(b){return{data:b.data.map(a)}}}(N),P=function(a,b){return function(c){return 400===c.status&&190===c.data.error.code&&(c.status=403),a.reject(b.toError(c))}}(a,h),Q=function(a,b,c){return function(d){function e(a){return b(a.data)}function f(a){return c(a)}function g(){return a.get(d.apiUrl+"/albums",null,{withCredentials:!0}).then(e,f)}return{list:g}}}(d,O,P),R=function(a,b){function c(a,c,d){d=d||190,c=c||190;var e,f,g;return 1===a.length?a[0].source:(e=a.filter(function(a){return a.width>c&&a.height>d}),(g=b.min(e,function(a){return a.width+a.height}))?g.source:(f=b.max(a,function(a){return a.width+a.height}),f.source))}return function(b){return{id:b.id,folderId:null,name:b.name||"",mediaType:"picture",fileUrl:a(b.source),thumbnailUrl:a(c(b.images)),previewUrl:a(b.source),createdAt:b.created_time,tags:[],width:b.width,height:b.height}}}(b,c),S=function(a){return function(b){return b.paging=b.paging||{},b.paging.cursors=b.paging.cursors||{},b.paging.cursors.after=b.paging.cursors.after||null,{data:b.data.map(a),paging:{cursor:b.paging.cursors.after,pageSize:null}}}}(R),T=function(a,b,c){return function(d){function e(a){return b(a.data)}function f(a){return c(a)}function g(b,c){c=c||{},c.paging=c.paging||{};var g={album_id:b,limit:c.paging.pageSize||50,after:c.paging.cursor||null};return a.get(d.apiUrl+"/photos",g,{withCredentials:!0}).then(e,f)}return{list:g}}}(d,S,P),U=function(a,b,c,d,e){return function(){var f=b(a),g=c(a);this.name="facebook",this.folders=d.addEvents(this,e.FOLDERS,f),this.items=d.addEvents(this,e.ITEMS,g)}}(M,Q,T,q,r),V={apiUrl:"http://pix-test.wix.com/services/flickr"},W=function(a){return{id:a.id,name:a.title._content,mediaType:"picture",parentId:null,filesCount:+a.photos+ +a.videos,createdAt:1e3*+a.date_create}},X=function(a){return function(b){return{data:b.photosets.photoset.map(a)}}}(W),Y=function(a,b){return function(c){return a.reject(b.toError(c))}}(a,h),Z=function(a,b,c){return function(d){function e(a){return b(a.data)}function f(a){return c(a)}function g(){return a.get(d.apiUrl+"/albums",{primary_photo_extras:"url_t,url_s,url_m,url_b,url_o"},{withCredentials:!0}).then(e,f)}return{list:g}}}(d,X,Y),$=function(a){function b(a){var b=a.url_m||a.url_s||a.url_t,c=a.url_b||b,d=a.url_o||c;return{fileUrl:d,thumbnailUrl:b,previewUrl:c}}return function(c){var d=b(c);return{id:c.id,name:c.title,folderId:null,mediaType:"picture",fileUrl:a(d.fileUrl),thumbnailUrl:a(d.thumbnailUrl),previewUrl:a(d.previewUrl),createdAt:null,tags:[],width:+(c.width_o||c.width_m||c.width_s||c.width_t),height:+(c.height_o||c.height_m||c.height_s||c.height_t)}}}(b),_=function(a){return function(b){var c=b.photoset.page<b.photoset.pages?b.photoset.page+1:null,d=+b.photoset.perpage;return{data:b.photoset.photo.map(a),paging:{cursor:c,pageSize:d}}}}($),ab=function(a,b,c){return function(d){function e(a){return"fail"===a.data.stat?c(a):b(a.data)}function f(a){return c(a)}function g(b,c){c=c||{},c.paging=c.paging||{};var g={extras:"url_t,url_s,url_m,url_b,url_o",set_id:b,per_page:c.paging.pageSize||50,page:c.paging.cursor||null};return a.get(d.apiUrl+"/photoset",g,{withCredentials:!0}).then(e,f)}return{list:g}}}(d,_,Y),bb=function(a,b,c,d,e){return function(){var f=b(a),g=c(a);this.name="flickr",this.folders=d.addEvents(this,e.FOLDERS,f),this.items=d.addEvents(this,e.ITEMS,g)}}(V,Z,ab,q,r),cb=function(a,b,c,d,e){return{PRIVATE:a,PICASA:b,INSTAGRAM:c,FACEBOOK:d,FLICKR:e}}(t,C,L,U,bb),db=function(a,b,c){function d(a,b){Object.defineProperty(e,a,{enumerable:!1,value:b})}var e={};return e=c.merge(b),d("on",a.addListener),d("off",a.removeListener),e}(e,r,c),eb={PICASA:{connectUrl:"http://pix-test.wix.com/services/google/connect",disconnectUrl:"http://pix-test.wix.com/services/google/disconnect",parameterName:"goglact"},INSTAGRAM:{connectUrl:"http://pix-test.wix.com/services/instagram/connect",disconnectUrl:"http://pix-test.wix.com/services/instagram/disconnect",parameterName:"instact"},FACEBOOK:{connectUrl:"http://pix-test.wix.com/services/facebook/connect",disconnectUrl:"http://pix-test.wix.com/services/facebook/disconnect",parameterName:"fbact"},FLICKR:{connectUrl:"http://pix-test.wix.com/services/flickr/connect",disconnectUrl:"http://pix-test.wix.com/services/flickr/disconnect",parameterName:"flact"}},fb=function(a,b,c,d){return function(e,f){function g(){return k.parameterName}function h(){return!!localStorage.getItem(k.parameterName)}function i(){localStorage.removeItem(k.parameterName),c.get(k.disconnectUrl,null,{withCredentials:!0})}function j(){var b;return window.open(k.connectUrl+"?return_url="+f.redirectUrl,"connector","width=950,height=550"),b=new a(function(a,b){window.connectService=function(c){var e,f;e=d.getParameterByName(c,g()),f=d.getParameterByName(c,"status"),!e||f&&"FAIL"===f?b("Not Authorized"):a(e)}}),b.then(function(a){localStorage.setItem(k.parameterName,a)},function(a){return a}),b}var k=b[e];if("object"!=typeof k)throw new Error("Invalid source");return{isConnected:h,disconnect:i,connect:j}}}(a,eb,d,c),gb={severity:{info:10,warning:20,error:30,fatal:40},BIEventsIds:{"folder.create":"112","folder.rename":"115","folder.remove":"117","item.remove":"118",responseTime:"125",searchItems:"126"},BIAdaptersIds:{"private":"01","public":"02",facebook:"03",flickr:"04",instagram:"05",picasa:"06",flickrSearch:"07",googleSearch:"08"},BIAdaptersRequestsIds:{"folders.list":"01","folder.create":"02","folder.rename":"03","folder.remove":"04","items.list":"11","item.upload":"12","item.uploadByUrl":"13","item.update":"14","item.remove":"15",moveItem:"16","items.search":"17",getMoreSearchedItems:"17",getItemsByTag:"18",transcodeItem:"19"}},hb=function(a,b){var c,d,e,f,g,h,i,j;return g=function(a,c){var d=document.createElement("img");d.setAttribute("src",a+"?"+b.encodeParams(c)),d=null},h=function(){return(new Date).getTime()},i=function(a,b,c){var d=a.name+"("+b+")",e=h()-c.startedAt;f({requestName:d,responseTime:e,isSuccess:c.isSuccess,responseSize:c.responseSize})},j=function(a,b){var c=h();a.then(function(){i(b.eventTarget,b.eventName,{startedAt:c,responseSize:0,isSuccess:!0})})["catch"](function(){i(b.eventTarget,b.eventName,{startedAt:c,responseSize:0,isSuccess:!1})})},c=function(){return"http://frog.wixpress.com"},e=function(a,b){return b.evid=a,g(c()+"/mg",b)},d=function(b,d,e){var f=e.code||"000",h=a.BIAdaptersIds[b]||"00",i=a.BIAdaptersRequestsIds[d]||"00",j=b+" "+d+": "+e.message,k=h+i+f;return g(c()+"/trg",{src:25,evid:10,iss:1,sev:a.severity.error,errc:k||"0000000",ver:"MEDIA_GALLERY_VERSION",site_id:"",httpc:f||"000",dsc:j||""})},f=function(b){return g(c()+"/mg",{evid:a.BIEventsIds.responseTime,call_name:b.requestName||"",ts:b.responseTime||0,result:b.isSuccess?"success":"fail",response_speed:Math.floor(b.responseSize||0/(b.responseTime/1e3)),response_size:b.responseSize})},{report:e,error:d,benchmark:j}}(gb,c),ib=function(a,b,c){return function(d){var e=function(a,b){c.benchmark(a,b);var d=function(a,b,d){c.error(a.name,b,d)},e=function(){},f=function(a){d(b.eventTarget,b.eventName,a)};return a.then(e,f)};Object.keys(b).forEach(function(c){Object.keys(b[c]).forEach(function(f){d===!0?a.addListener(b[c][f],e):a.removeListener(b[c][f],e)})})}}(e,r,hb),jb=function(a,b,c,d,e){return{Source:a,sources:b,events:c,bi:e,connectExternalSource:d}}(f,cb,db,fb,ib),window.wixmp=jb}();